
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="This tool extracts metadata regarding NMR data from multiple repositories and creates FAIR-DOs for them.">
      
      
        <meta name="author" content="Maximilian Inckmann <maximilian.inckmann@kit.edu>">
      
      
        <link rel="canonical" href="https://kit-data-manager.github.io/nmr_FAIR-DOs/v0.1.0/reference/nmr_FAIR_DOs/lib/">
      
      
        <link rel="prev" href="../env/">
      
      
        <link rel="next" href="../repositories/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.3">
    
    
      
        <title>lib - nmr_FAIR-DOs</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.d7758b05.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_markdown_exec_pyodide.css">
    
      <link rel="stylesheet" href="../../../assets/_markdown_exec_ansi.css">
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../css/style.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#nmr_FAIR_DOs.lib" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
  This page is for an outdated or development version.
<!--
  ~ SPDX-FileCopyrightText: 2025 Karlsruhe Institute of Technology <maximilian.inckmann@kit.edu>
  ~ SPDX-License-Identifier: Apache-2.0
  ~
  ~ Copyright (c) 2025. Karlsruhe Institute of Technology
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ You may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~   http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->

<!--
-->

<a href="../../../..">
    <strong>Click here to go to the latest stable version.</strong>
  </a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),base=new URL("../../.."),outdated=__md_get("__outdated",sessionStorage,base);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="nmr_FAIR-DOs" class="md-header__button md-logo" aria-label="nmr_FAIR-DOs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            nmr_FAIR-DOs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              lib
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/kit-data-manager/nmr_FAIR-DOs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    nmr_FAIR-DOs
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../.." class="md-tabs__link">
          
  
  Home

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../../quickstart/" class="md-tabs__link">
          
  
  Usage

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../contributing/" class="md-tabs__link">
          
  
  Development

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="nmr_FAIR-DOs" class="md-nav__button md-logo" aria-label="nmr_FAIR-DOs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    nmr_FAIR-DOs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/kit-data-manager/nmr_FAIR-DOs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    nmr_FAIR-DOs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Home
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../changelog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Changelog
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../credits/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Credits
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../license/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    License
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Usage
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Usage
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../quickstart/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quickstart
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_1" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    nmr_FAIR_DOs
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_2_1" id="__nav_2_2_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_2_1">
            <span class="md-nav__icon md-icon"></span>
            nmr_FAIR_DOs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cli
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_1_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../connectors/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    connectors
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_2_1_2" id="__nav_2_2_1_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_2_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_1_2">
            <span class="md-nav__icon md-icon"></span>
            connectors
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../connectors/elasticsearch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    elasticsearch
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../connectors/terminology/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    terminology
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../connectors/tpm_connector/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    tpm_connector
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_1_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../domain/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    domain
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_2_1_3" id="__nav_2_2_1_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_2_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_1_3">
            <span class="md-nav__icon md-icon"></span>
            domain
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../domain/dataType/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dataType
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../domain/pid_record/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pid_record
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../domain/pid_record_entry/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pid_record_entry
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../env/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    env
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    lib
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    lib
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#nmr_FAIR_DOs.lib" class="md-nav__link">
    <span class="md-ellipsis">
      lib
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nmr_FAIR_DOs.lib.getRepository" class="md-nav__link">
    <span class="md-ellipsis">
      getRepository
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nmr_FAIR_DOs.lib.getRepositories" class="md-nav__link">
    <span class="md-ellipsis">
      getRepositories
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nmr_FAIR_DOs.lib.addRelationship" class="md-nav__link">
    <span class="md-ellipsis">
      addRelationship
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nmr_FAIR_DOs.lib.create_pidRecords_from_resources" class="md-nav__link">
    <span class="md-ellipsis">
      create_pidRecords_from_resources
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nmr_FAIR_DOs.lib.create_pidRecords_from_scratch" class="md-nav__link">
    <span class="md-ellipsis">
      create_pidRecords_from_scratch
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nmr_FAIR_DOs.lib.add_all_existing_pidRecords_to_elasticsearch" class="md-nav__link">
    <span class="md-ellipsis">
      add_all_existing_pidRecords_to_elasticsearch
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nmr_FAIR_DOs.lib.extractBiggestFAIRDO" class="md-nav__link">
    <span class="md-ellipsis">
      extractBiggestFAIRDO
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nmr_FAIR_DOs.lib.extractRecordWithMostDataTypes" class="md-nav__link">
    <span class="md-ellipsis">
      extractRecordWithMostDataTypes
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_1_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../repositories/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    repositories
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_2_1_6" id="__nav_2_2_1_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_2_1_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_1_6">
            <span class="md-nav__icon md-icon"></span>
            repositories
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../repositories/AbstractRepository/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AbstractRepository
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../repositories/chemotion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    chemotion
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../repositories/nmrxiv/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    nmrxiv
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    utils
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Development
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Development
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How To Contribute
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../dev_guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Developer Guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../code_of_conduct/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Code of Conduct
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#nmr_FAIR_DOs.lib" class="md-nav__link">
    <span class="md-ellipsis">
      lib
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nmr_FAIR_DOs.lib.getRepository" class="md-nav__link">
    <span class="md-ellipsis">
      getRepository
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nmr_FAIR_DOs.lib.getRepositories" class="md-nav__link">
    <span class="md-ellipsis">
      getRepositories
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nmr_FAIR_DOs.lib.addRelationship" class="md-nav__link">
    <span class="md-ellipsis">
      addRelationship
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nmr_FAIR_DOs.lib.create_pidRecords_from_resources" class="md-nav__link">
    <span class="md-ellipsis">
      create_pidRecords_from_resources
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nmr_FAIR_DOs.lib.create_pidRecords_from_scratch" class="md-nav__link">
    <span class="md-ellipsis">
      create_pidRecords_from_scratch
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nmr_FAIR_DOs.lib.add_all_existing_pidRecords_to_elasticsearch" class="md-nav__link">
    <span class="md-ellipsis">
      add_all_existing_pidRecords_to_elasticsearch
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nmr_FAIR_DOs.lib.extractBiggestFAIRDO" class="md-nav__link">
    <span class="md-ellipsis">
      extractBiggestFAIRDO
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nmr_FAIR_DOs.lib.extractRecordWithMostDataTypes" class="md-nav__link">
    <span class="md-ellipsis">
      extractRecordWithMostDataTypes
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/kit-data-manager/nmr_FAIR-DOs/edit/main/docs/src/nmr_FAIR_DOs/lib.py" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/kit-data-manager/nmr_FAIR-DOs/raw/main/docs/src/nmr_FAIR_DOs/lib.py" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


  <h1>lib</h1>

<div class="doc doc-object doc-module">



<a id="nmr_FAIR_DOs.lib"></a>
    <div class="doc doc-contents first">

      <p>This module contains the main functionality to create PID records from resources and to add them to the Typed PID-Maker and Elasticsearch.
It initializes the repositories and the connectors and provides functions to add entries to PID records and to create PID records from resources or from scratch.</p>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="nmr_FAIR_DOs.lib.getRepository" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">getRepository</span>


<a href="#nmr_FAIR_DOs.lib.getRepository" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">getRepository</span><span class="p">(</span><span class="n">repo</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AbstractRepository</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Get the repository object for the given repository name. If the repository is not found, a ValueError is raised.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>repo</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the repository</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>AbstractRepository</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="nmr_FAIR_DOs.repositories.AbstractRepository.AbstractRepository" href="../repositories/AbstractRepository/#nmr_FAIR_DOs.repositories.AbstractRepository.AbstractRepository">AbstractRepository</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The repository object</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the repository is not found</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/nmr_FAIR_DOs/lib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">getRepository</span><span class="p">(</span><span class="n">repo</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AbstractRepository</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the repository object for the given repository name. If the repository is not found, a ValueError is raised.</span>

<span class="sd">    Args:</span>
<span class="sd">        repo (str): The name of the repository</span>

<span class="sd">    Returns:</span>
<span class="sd">        AbstractRepository: The repository object</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the repository is not found</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">repository</span> <span class="ow">in</span> <span class="n">_REPOSITORIES</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">repository</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">repo</span><span class="o">.</span><span class="n">upper</span><span class="p">():</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Found repository </span><span class="si">{</span><span class="n">repository</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">repository</span><span class="o">.</span><span class="n">value</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Repository not found&quot;</span><span class="p">,</span> <span class="n">repo</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="nmr_FAIR_DOs.lib.getRepositories" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">getRepositories</span>


<a href="#nmr_FAIR_DOs.lib.getRepositories" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">getRepositories</span><span class="p">(</span>
    <span class="n">repos</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">AbstractRepository</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Get the repository objects for the given repository names.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>repos</code></td>
            <td>
                  <code>str | list[str] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the repositories or None to get all repositories</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list[<a class="autorefs autorefs-internal" title="nmr_FAIR_DOs.repositories.AbstractRepository.AbstractRepository" href="../repositories/AbstractRepository/#nmr_FAIR_DOs.repositories.AbstractRepository.AbstractRepository">AbstractRepository</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[AbstractRepository]: The repository objects</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the input is invalid</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/nmr_FAIR_DOs/lib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">getRepositories</span><span class="p">(</span><span class="n">repos</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">AbstractRepository</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the repository objects for the given repository names.</span>

<span class="sd">    Args:</span>
<span class="sd">        repos (str| list[str] | None): The name of the repositories or None to get all repositories</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[AbstractRepository]: The repository objects</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the input is invalid</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">repos</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">repo</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">repo</span> <span class="ow">in</span> <span class="n">_REPOSITORIES</span><span class="p">]</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">repos</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">getRepository</span><span class="p">(</span><span class="n">repos</span><span class="p">)]</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">repos</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">repos</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">repos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Getting all repositories&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">repo</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">repo</span> <span class="ow">in</span> <span class="n">_REPOSITORIES</span><span class="p">]</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">getRepository</span><span class="p">(</span><span class="n">repo</span><span class="p">)</span> <span class="k">for</span> <span class="n">repo</span> <span class="ow">in</span> <span class="n">repos</span><span class="p">]</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid input&quot;</span><span class="p">,</span> <span class="n">repos</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="nmr_FAIR_DOs.lib.addRelationship" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">addRelationship</span>


<a href="#nmr_FAIR_DOs.lib.addRelationship" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">addRelationship</span><span class="p">(</span>
    <span class="n">presumed_pid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">entries</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">PIDRecordEntry</span><span class="p">],</span>
    <span class="n">onSuccess</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allowRetry</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>This method creates a relationship between two FAIR-DOs by adding entries to the PID record with the given PID.
To accomplish this, the method first checks if the PID record already exists in the list of PID records to be created or in the list of PID records.
If the PID record is not found, the method searches for the PID record in Elasticsearch and gets it from the Typed PID-Maker.
If the PID record is still not found, the method raises an exception.
The method then adds the entries to the PID record and calls the onSuccess function if it is given.
Usually, this onSuccess function is used to add a relationship from the target PID record to the PID of the PID record that the entries are added to.
This feature allows the creation of bidirectional relationships between two FAIR-DOs.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>presumed_pid</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The PID of the target PID record.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>entries</code></td>
            <td>
                  <code>list[<a class="autorefs autorefs-internal" title="nmr_FAIR_DOs.domain.pid_record_entry.PIDRecordEntry" href="../domain/pid_record_entry/#nmr_FAIR_DOs.domain.pid_record_entry.PIDRecordEntry">PIDRecordEntry</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The PIDRecordEntries to add to the PID record. See PIDRecordEntry for more information.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>onSuccess</code></td>
            <td>
                  <code>function</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The function to call after the entries have been added to the PID record (optional). This function gets the PID of the PID record as an argument.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>allowRetry</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If true, the function will retry to add the entries to the PID record if it fails the first time (optional). Default is True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The PID of the PID record the entries were added to or "None" if the PID record was not found.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>Exception</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If any error occurs during the addition of the entries to the PID record</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/nmr_FAIR_DOs/lib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">addRelationship</span><span class="p">(</span>
    <span class="n">presumed_pid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">entries</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">PIDRecordEntry</span><span class="p">],</span>
    <span class="n">onSuccess</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allowRetry</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This method creates a relationship between two FAIR-DOs by adding entries to the PID record with the given PID.</span>
<span class="sd">    To accomplish this, the method first checks if the PID record already exists in the list of PID records to be created or in the list of PID records.</span>
<span class="sd">    If the PID record is not found, the method searches for the PID record in Elasticsearch and gets it from the Typed PID-Maker.</span>
<span class="sd">    If the PID record is still not found, the method raises an exception.</span>
<span class="sd">    The method then adds the entries to the PID record and calls the onSuccess function if it is given.</span>
<span class="sd">    Usually, this onSuccess function is used to add a relationship from the target PID record to the PID of the PID record that the entries are added to.</span>
<span class="sd">    This feature allows the creation of bidirectional relationships between two FAIR-DOs.</span>

<span class="sd">    Args:</span>
<span class="sd">        presumed_pid (str): The PID of the target PID record.</span>
<span class="sd">        entries (list[PIDRecordEntry]): The PIDRecordEntries to add to the PID record. See PIDRecordEntry for more information.</span>
<span class="sd">        onSuccess (function): The function to call after the entries have been added to the PID record (optional). This function gets the PID of the PID record as an argument.</span>
<span class="sd">        allowRetry (bool): If true, the function will retry to add the entries to the PID record if it fails the first time (optional). Default is True.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The PID of the PID record the entries were added to or &quot;None&quot; if the PID record was not found.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: If any error occurs during the addition of the entries to the PID record</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Adding entries to PID record with PID </span><span class="si">{</span><span class="n">presumed_pid</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">,</span> <span class="n">entries</span><span class="p">)</span>

    <span class="n">cleartext_presumed_pid</span> <span class="o">=</span> <span class="n">decodeFromBase64</span><span class="p">(</span>
        <span class="n">presumed_pid</span>
    <span class="p">)</span>  <span class="c1"># decode the presumed PID from base64</span>

    <span class="c1"># Check if the PID record already exists in the list of PID records to be created</span>
    <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">records_to_create</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">record</span><span class="o">.</span><span class="n">getPID</span><span class="p">()</span> <span class="o">==</span> <span class="n">presumed_pid</span>
        <span class="p">):</span>  <span class="c1"># PID of the record matches the presumed PID</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Adding entries to record in creation with PID </span><span class="si">{</span><span class="n">presumed_pid</span><span class="si">}</span><span class="s2">. Identified by PID.&quot;</span><span class="p">,</span>
                <span class="n">entries</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">record</span><span class="o">.</span><span class="n">addListOfEntries</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span>  <span class="c1"># add entries to the record</span>
            <span class="k">if</span> <span class="n">onSuccess</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span>
                <span class="n">onSuccess</span>
            <span class="p">):</span>  <span class="c1"># call onSuccess function if it is given and callable</span>
                <span class="n">onSuccess</span><span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">getPID</span><span class="p">())</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="n">record</span><span class="o">.</span><span class="n">getPID</span><span class="p">()</span>
            <span class="p">)</span>  <span class="c1"># return the PID of the record the entries were added to. SUCCESS</span>
        <span class="k">elif</span> <span class="n">record</span><span class="o">.</span><span class="n">entryExists</span><span class="p">(</span>
            <span class="s2">&quot;21.T11148/b8457812905b83046284&quot;</span><span class="p">,</span> <span class="n">cleartext_presumed_pid</span>
        <span class="p">):</span>  <span class="c1"># The value of digitalObjectLocation matches the presumed PID</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Adding entries to record in creation with PID </span><span class="si">{</span><span class="n">presumed_pid</span><span class="si">}</span><span class="s2">. Identified by digitalObjectLocation.&quot;</span><span class="p">,</span>
                <span class="n">entries</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">record</span><span class="o">.</span><span class="n">addListOfEntries</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span>  <span class="c1"># add entries to the record</span>
            <span class="k">if</span> <span class="n">onSuccess</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span>
                <span class="n">onSuccess</span>
            <span class="p">):</span>  <span class="c1"># call onSuccess function if it is given and callable</span>
                <span class="n">onSuccess</span><span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">getPID</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">record</span><span class="o">.</span><span class="n">getPID</span><span class="p">()</span>

    <span class="c1"># Check if the PID record already exists in the list of PID records</span>
    <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">pid_records</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">record</span><span class="o">.</span><span class="n">getPID</span><span class="p">()</span> <span class="o">==</span> <span class="n">presumed_pid</span>
        <span class="p">):</span>  <span class="c1"># PID of the record matches the presumed PID</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Adding entries to existing record with PID </span><span class="si">{</span><span class="n">presumed_pid</span><span class="si">}</span><span class="s2">. Identified by PID.&quot;</span><span class="p">,</span>
                <span class="n">entries</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">record</span><span class="o">.</span><span class="n">addListOfEntries</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span>  <span class="c1"># add entries to the record</span>
            <span class="n">tpm</span><span class="o">.</span><span class="n">updatePIDRecord</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>  <span class="c1"># update PID record in the Typed PID-Maker</span>
            <span class="k">if</span> <span class="n">onSuccess</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span>
                <span class="n">onSuccess</span>
            <span class="p">):</span>  <span class="c1"># call onSuccess function if it is given and callable</span>
                <span class="n">onSuccess</span><span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">getPID</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">record</span><span class="o">.</span><span class="n">getPID</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">record</span><span class="o">.</span><span class="n">entryExists</span><span class="p">(</span>
            <span class="s2">&quot;21.T11148/b8457812905b83046284&quot;</span><span class="p">,</span> <span class="n">cleartext_presumed_pid</span>
        <span class="p">):</span>  <span class="c1"># The value of digitalObjectLocation matches the presumed PID</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Adding entries to existing record with PID </span><span class="si">{</span><span class="n">presumed_pid</span><span class="si">}</span><span class="s2">. Identified by digitalObjectLocation.&quot;</span><span class="p">,</span>
                <span class="n">entries</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">record</span><span class="o">.</span><span class="n">addListOfEntries</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span>  <span class="c1"># add entries to the record</span>
            <span class="n">tpm</span><span class="o">.</span><span class="n">updatePIDRecord</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>  <span class="c1"># update PID record in the Typed PID-Maker</span>
            <span class="k">if</span> <span class="n">onSuccess</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">onSuccess</span><span class="p">):</span>
                <span class="n">onSuccess</span><span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">getPID</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">record</span><span class="o">.</span><span class="n">getPID</span><span class="p">()</span>

    <span class="c1"># Check if the PID record exists in Elasticsearch and get it from the Typed PID-Maker</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;Couldn&#39;t find a record to add entries to. Calling add_relationship function. Starting to search in elasticsearch.&quot;</span>
        <span class="p">)</span>
        <span class="n">pid</span> <span class="o">=</span> <span class="n">elasticsearch</span><span class="o">.</span><span class="n">searchForPID</span><span class="p">(</span>
            <span class="n">cleartext_presumed_pid</span>
        <span class="p">)</span>  <span class="c1"># search for the PID in Elasticsearch</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="n">pid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="p">):</span>  <span class="c1"># PID found in Elasticsearch. This is the most probable match determined by Elasticsearch for the presumed PID</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Found PID record in Elasticsearch with PID </span><span class="si">{</span><span class="n">pid</span><span class="si">}</span><span class="s2">. Adding entries to it.&quot;</span>
            <span class="p">)</span>
            <span class="n">record</span> <span class="o">=</span> <span class="n">tpm</span><span class="o">.</span><span class="n">getPIDRecord</span><span class="p">(</span>
                <span class="n">pid</span>
            <span class="p">)</span>  <span class="c1"># get the PID record from the Typed PID-Maker with the found PID from Elasticsearch</span>

            <span class="k">if</span> <span class="n">record</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span>
                <span class="n">record</span><span class="p">,</span> <span class="n">PIDRecord</span>
            <span class="p">):</span>  <span class="c1"># Check if a PID record was found in the Typed PID-Maker</span>
                <span class="n">record</span><span class="o">.</span><span class="n">addListOfEntries</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span>  <span class="c1"># add entries to the record</span>
                <span class="n">pid_records</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">record</span>
                <span class="p">)</span>  <span class="c1"># add the record to the list of PID records for future use</span>
                <span class="n">tpm</span><span class="o">.</span><span class="n">updatePIDRecord</span><span class="p">(</span>
                    <span class="n">record</span>
                <span class="p">)</span>  <span class="c1"># update the PID record in the Typed PID-Maker</span>
                <span class="k">if</span> <span class="n">onSuccess</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span>
                    <span class="n">onSuccess</span>
                <span class="p">):</span>  <span class="c1"># call onSuccess function if it is given and callable</span>
                    <span class="n">onSuccess</span><span class="p">(</span>
                        <span class="n">record</span><span class="o">.</span><span class="n">getPID</span><span class="p">()</span>
                    <span class="p">)</span>  <span class="c1"># call onSuccess function with the PID of the record</span>
                <span class="k">return</span> <span class="n">record</span><span class="o">.</span><span class="n">getPID</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>  <span class="c1"># Something went wrong during the search in Elasticsearch or getting the PID record from the Typed PID-Maker</span>
        <span class="k">if</span> <span class="n">allowRetry</span><span class="p">:</span>  <span class="c1"># Retry is enabled -&gt; add the entries to the list of future entries for future use</span>
            <span class="n">future_entry</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;presumed_pid&quot;</span><span class="p">:</span> <span class="n">presumed_pid</span><span class="p">,</span> <span class="s2">&quot;entries&quot;</span><span class="p">:</span> <span class="n">entries</span><span class="p">}</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Could not find a PID record locally or in Elasticsearch with PID </span><span class="si">{</span><span class="n">presumed_pid</span><span class="si">}</span><span class="s2"> aka </span><span class="si">{</span><span class="n">cleartext_presumed_pid</span><span class="si">}</span><span class="s2">. Reminding entry for future use. </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">future_entry</span><span class="p">,</span>
                <span class="n">pid_records</span><span class="p">,</span>
                <span class="n">e</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">presumed_pid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">entries</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="p">):</span>  <span class="c1"># Check if the presumed PID and the entries are not None</span>
                <span class="n">future_entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">future_entry</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># Retry is disabled -&gt; raise an exception</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Retry disabled. Error adding entries to PID record </span><span class="si">{</span><span class="n">presumed_pid</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">entries</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s2">&quot;Error adding entries to PID record. Retry disabled.&quot;</span><span class="p">,</span>
                <span class="n">presumed_pid</span><span class="p">,</span>
                <span class="n">entries</span><span class="p">,</span>
                <span class="n">e</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">return</span> <span class="s2">&quot;None&quot;</span>  <span class="c1"># No PID record found. Return &quot;None&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="nmr_FAIR_DOs.lib.create_pidRecords_from_resources" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">create_pidRecords_from_resources</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#nmr_FAIR_DOs.lib.create_pidRecords_from_resources" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">create_pidRecords_from_resources</span><span class="p">(</span>
    <span class="n">repo</span><span class="p">:</span> <span class="n">AbstractRepository</span><span class="p">,</span> <span class="n">resources</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>This function PID records for the given resources of the given repository.
It extracts the PID records from the resources and adds them to the list of PID records to be created.
If the repository FDO is not found, it is created and added to the list of PID records to be created.
If an error occurs during the creation of the PID records, the error is added to the list of errors for further investigation by the user.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>repo</code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="nmr_FAIR_DOs.repositories.AbstractRepository.AbstractRepository" href="../repositories/AbstractRepository/#nmr_FAIR_DOs.repositories.AbstractRepository.AbstractRepository">AbstractRepository</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The repository to create PID records for</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>resources</code></td>
            <td>
                  <code>list[dict]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of resources to create PID records from (e.g., JSON objects). The format of the resources is repository specific.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[PIDRecord]: A list of PID records created from the provided resources</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>Exception</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If an error occurs during the creation of the PID records</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/nmr_FAIR_DOs/lib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">create_pidRecords_from_resources</span><span class="p">(</span>
    <span class="n">repo</span><span class="p">:</span> <span class="n">AbstractRepository</span><span class="p">,</span> <span class="n">resources</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function PID records for the given resources of the given repository.</span>
<span class="sd">    It extracts the PID records from the resources and adds them to the list of PID records to be created.</span>
<span class="sd">    If the repository FDO is not found, it is created and added to the list of PID records to be created.</span>
<span class="sd">    If an error occurs during the creation of the PID records, the error is added to the list of errors for further investigation by the user.</span>

<span class="sd">    Args:</span>
<span class="sd">        repo (AbstractRepository): The repository to create PID records for</span>
<span class="sd">        resources (list[dict]): A list of resources to create PID records from (e.g., JSON objects). The format of the resources is repository specific.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[PIDRecord]: A list of PID records created from the provided resources</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: If an error occurs during the creation of the PID records</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Creating PID records for the </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">resources</span><span class="p">)</span><span class="si">}</span><span class="s2"> resources&quot;</span><span class="p">)</span>

    <span class="c1"># get repository FDO</span>
    <span class="n">repo_FDO</span><span class="p">,</span> <span class="n">isNew</span> <span class="o">=</span> <span class="k">await</span> <span class="n">_getRepoFAIRDO</span><span class="p">(</span><span class="n">repo</span><span class="p">)</span>

    <span class="c1"># Extract PID records from the resources</span>
    <span class="k">for</span> <span class="n">resource</span> <span class="ow">in</span> <span class="n">resources</span><span class="p">:</span>  <span class="c1"># iterate over the resources</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Extracting PID record from </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">resource</span><span class="p">)[:</span><span class="mi">100</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">pid_record</span> <span class="o">=</span> <span class="k">await</span> <span class="n">repo</span><span class="o">.</span><span class="n">extractPIDRecordFromResource</span><span class="p">(</span>
                <span class="n">resource</span><span class="p">,</span> <span class="n">addRelationship</span>
            <span class="p">)</span>  <span class="c1"># extract PID record from the resource</span>
            <span class="k">if</span> <span class="n">pid_record</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span>
                <span class="n">pid_record</span><span class="p">,</span> <span class="n">PIDRecord</span>
            <span class="p">):</span>  <span class="c1"># Check if a PID record was extracted</span>
                <span class="n">pid_record</span><span class="o">.</span><span class="n">addEntry</span><span class="p">(</span>  <span class="c1"># add the repository FDO as primary source to the PID record</span>
                    <span class="s2">&quot;21.T11148/a753134738da82809fc1&quot;</span><span class="p">,</span>
                    <span class="n">repo_FDO</span><span class="o">.</span><span class="n">getPID</span><span class="p">(),</span>
                    <span class="s2">&quot;hadPrimarySource&quot;</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="c1"># repo_FDO.addEntry( TODO: add this entry to the repository FDO; disabled due to size constraints of Handle records (problems at ~400 KB; actual size of repository FDO: ~2.9 MB)</span>
                <span class="c1">#     &quot;21.T11148/4fe7cde52629b61e3b82&quot;,</span>
                <span class="c1">#     pid_record.getPID(),</span>
                <span class="c1">#     &quot;isMetadataFor&quot;,</span>
                <span class="c1"># )</span>
                <span class="n">records_to_create</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">pid_record</span>
                <span class="p">)</span>  <span class="c1"># add the PID record to the list of PID records to be created</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># No PID record extracted from the resource -&gt; add an error to the list of errors</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No PID record extracted from </span><span class="si">{</span><span class="n">resource</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="n">resource</span><span class="p">,</span>
                        <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;No PID record extracted&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
                    <span class="p">}</span>
                <span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>  <span class="c1"># An error occurred during the extraction of the PID record -&gt; add an error to the list of errors</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error extracting PID record from </span><span class="si">{</span><span class="n">resource</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="c1"># &quot;url&quot;: resource,</span>
                    <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span>
                    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
                <span class="p">}</span>
            <span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Dealing with future entries&quot;</span><span class="p">,</span> <span class="n">future_entries</span><span class="p">)</span>
    <span class="c1"># Add entries from future entries to PID records (second attempt)</span>
    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">future_entries</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># while there are future entries</span>
        <span class="n">entry</span> <span class="o">=</span> <span class="n">future_entries</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>  <span class="c1"># get the first entry</span>
        <span class="k">try</span><span class="p">:</span>  <span class="c1"># try to add the entries to the PID record</span>
            <span class="n">pid</span> <span class="o">=</span> <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;presumed_pid&quot;</span><span class="p">]</span>
            <span class="n">entries</span> <span class="o">=</span> <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;entries&quot;</span><span class="p">]</span>

            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Adding entries to PID record with PID </span><span class="si">{</span><span class="n">pid</span><span class="si">}</span><span class="s2"> from future entries (second attempt).&quot;</span><span class="p">,</span>
                <span class="n">entries</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="n">addRelationship</span><span class="p">(</span>
                <span class="n">pid</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">False</span>
            <span class="p">)</span>  <span class="c1"># add the entries to the PID record (without retry to ensure that no infinite loop is created)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>  <span class="c1"># An error occurred during the addition of the entries to the PID record -&gt; add an error to the list of errors</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Error adding entries to PID record with PID </span><span class="si">{</span><span class="n">entry</span><span class="p">[</span><span class="s1">&#39;presumed_pid&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> from future entries. This was the second and last attempt.&quot;</span><span class="p">,</span>
                <span class="n">entry</span><span class="p">,</span>
                <span class="n">e</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;presumed_pid&quot;</span><span class="p">],</span>
                    <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span>
                    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
                <span class="p">}</span>
            <span class="p">)</span>

    <span class="k">if</span> <span class="n">isNew</span><span class="p">:</span>  <span class="c1"># Check if the repository FDO is newly created</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Creating repository FDO with preliminary PID </span><span class="si">{</span><span class="n">repo_FDO</span><span class="o">.</span><span class="n">getPID</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">records_to_create</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">repo_FDO</span>
        <span class="p">)</span>  <span class="c1"># add the repository FDO to the list of PID records to be created</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># The repository FDO is not newly created</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Updating repository FDO with actual PID </span><span class="si">{</span><span class="n">repo_FDO</span><span class="o">.</span><span class="n">getPID</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">tpm</span><span class="o">.</span><span class="n">updatePIDRecord</span><span class="p">(</span>
            <span class="n">repo_FDO</span>
        <span class="p">)</span>  <span class="c1"># update the repository FDO in the Typed PID-Maker</span>
        <span class="k">await</span> <span class="n">elasticsearch</span><span class="o">.</span><span class="n">addPIDRecord</span><span class="p">(</span>
            <span class="n">repo_FDO</span>
        <span class="p">)</span>  <span class="c1"># add the repository FDO to Elasticsearch</span>

    <span class="c1"># write errors to file</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;errors_&quot;</span> <span class="o">+</span> <span class="n">repo</span><span class="o">.</span><span class="n">repositoryID</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.json&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">errors</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Errors written to file errors.json&quot;</span><span class="p">)</span>

    <span class="c1"># write PID records to file</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span>
        <span class="s2">&quot;records_to_create&quot;</span> <span class="o">+</span> <span class="n">repo</span><span class="o">.</span><span class="n">repositoryID</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.json&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span>
    <span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">([</span><span class="n">record</span><span class="o">.</span><span class="n">toJSON</span><span class="p">()</span> <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">records_to_create</span><span class="p">],</span> <span class="n">f</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;PID records written to file records_to_create.json&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="nmr_FAIR_DOs.lib.create_pidRecords_from_scratch" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">create_pidRecords_from_scratch</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#nmr_FAIR_DOs.lib.create_pidRecords_from_scratch" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">create_pidRecords_from_scratch</span><span class="p">(</span>
    <span class="n">repos</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">AbstractRepository</span><span class="p">],</span>
    <span class="n">start</span><span class="p">:</span> <span class="n">datetime</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">end</span><span class="p">:</span> <span class="n">datetime</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">dryrun</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">PIDRecord</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Create PID records from scratch for the given time frame or all available URLs if no time frame is given.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>repos</code></td>
            <td>
                  <code>list[<a class="autorefs autorefs-internal" title="nmr_FAIR_DOs.repositories.AbstractRepository.AbstractRepository" href="../repositories/AbstractRepository/#nmr_FAIR_DOs.repositories.AbstractRepository.AbstractRepository">AbstractRepository</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The repositories to create PID records for. If None, all available repositories are used.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>start</code></td>
            <td>
                  <code><span title="datetime.datetime">datetime</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The start of the time frame. If None, all available URLs are used.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>end</code></td>
            <td>
                  <code><span title="datetime.datetime">datetime</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The end of the time frame. If None, all available URLs are used.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>dryrun</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If true, the PID records will not be created in TPM or Elasticsearch</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list[<a class="autorefs autorefs-internal" title="nmr_FAIR_DOs.domain.pid_record.PIDRecord" href="../domain/pid_record/#nmr_FAIR_DOs.domain.pid_record.PIDRecord">PIDRecord</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[PIDRecord]: A list of PID records created from scratch</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>Exception</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If an error occurs during the creation of the PID records</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/nmr_FAIR_DOs/lib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">create_pidRecords_from_scratch</span><span class="p">(</span>
    <span class="n">repos</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">AbstractRepository</span><span class="p">],</span>
    <span class="n">start</span><span class="p">:</span> <span class="n">datetime</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">end</span><span class="p">:</span> <span class="n">datetime</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">dryrun</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">PIDRecord</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create PID records from scratch for the given time frame or all available URLs if no time frame is given.</span>

<span class="sd">    Args:</span>
<span class="sd">        repos (list[AbstractRepository]): The repositories to create PID records for. If None, all available repositories are used.</span>
<span class="sd">        start (datetime): The start of the time frame. If None, all available URLs are used.</span>
<span class="sd">        end (datetime): The end of the time frame. If None, all available URLs are used.</span>
<span class="sd">        dryrun (bool): If true, the PID records will not be created in TPM or Elasticsearch</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[PIDRecord]: A list of PID records created from scratch</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: If an error occurs during the creation of the PID records</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">repo</span> <span class="ow">in</span> <span class="n">repos</span><span class="p">:</span>  <span class="c1"># iterate over the repositories</span>
        <span class="n">resources</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># list of resources to create PID records from</span>

        <span class="c1"># Get the URLs for the given time frame or all available URLs if no time frame is given</span>
        <span class="k">if</span> <span class="p">(</span>  <span class="c1"># Check if the start and end of the time frame are given and are of type datetime</span>
            <span class="n">start</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="ow">and</span> <span class="n">end</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">datetime</span><span class="p">)</span>
            <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">end</span><span class="p">,</span> <span class="n">datetime</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="n">resources</span> <span class="o">=</span> <span class="k">await</span> <span class="n">repo</span><span class="o">.</span><span class="n">getResourcesForTimeFrame</span><span class="p">(</span>
                <span class="n">start</span><span class="p">,</span> <span class="n">end</span>
            <span class="p">)</span>  <span class="c1"># get the resources for the given time frame</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;last_run_&quot;</span> <span class="o">+</span> <span class="n">repo</span><span class="o">.</span><span class="n">repositoryID</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">),</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">())</span>
            <span class="n">resources</span> <span class="o">=</span> <span class="p">(</span>
                <span class="k">await</span> <span class="n">repo</span><span class="o">.</span><span class="n">getAllAvailableResources</span><span class="p">()</span>
            <span class="p">)</span>  <span class="c1"># get all available resources</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Creating PID records from scratch for </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">resources</span><span class="p">)</span><span class="si">}</span><span class="s2"> resources&quot;</span><span class="p">)</span>

        <span class="k">await</span> <span class="n">create_pidRecords_from_resources</span><span class="p">(</span>
            <span class="n">repo</span><span class="p">,</span> <span class="n">resources</span>
        <span class="p">)</span>  <span class="c1"># create PID records from the resources</span>

    <span class="n">real_pid_records</span> <span class="o">=</span> <span class="k">await</span> <span class="n">_createRecordsToCreate</span><span class="p">(</span>
        <span class="n">dryrun</span>
    <span class="p">)</span>  <span class="c1"># create PID records in TPM and Elasticsearch</span>

    <span class="c1"># write PID records to file</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;pid_records_all.json&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">([</span><span class="n">record</span><span class="o">.</span><span class="n">toJSON</span><span class="p">()</span> <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">pid_records</span><span class="p">],</span> <span class="n">f</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;PID records written to file pid_records.json&quot;</span><span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Finished creating </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">real_pid_records</span><span class="p">)</span><span class="si">}</span><span class="s2"> PID records in </span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start_time</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">real_pid_records</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="nmr_FAIR_DOs.lib.add_all_existing_pidRecords_to_elasticsearch" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">add_all_existing_pidRecords_to_elasticsearch</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#nmr_FAIR_DOs.lib.add_all_existing_pidRecords_to_elasticsearch" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">add_all_existing_pidRecords_to_elasticsearch</span><span class="p">(</span>
    <span class="n">fromFile</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Add all existing PID records to Elasticsearch. If fromFile is not None, the PID records will be read from a file instead of the Typed PID-Maker.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>fromFile</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If true, the PID records will be read from a file instead of the Typed PID-Maker. Default is None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>Exception</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If an error occurs during the addition of the PID records to Elasticsearch</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/nmr_FAIR_DOs/lib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">add_all_existing_pidRecords_to_elasticsearch</span><span class="p">(</span><span class="n">fromFile</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add all existing PID records to Elasticsearch. If fromFile is not None, the PID records will be read from a file instead of the Typed PID-Maker.</span>

<span class="sd">    Args:</span>
<span class="sd">        fromFile (bool): If true, the PID records will be read from a file instead of the Typed PID-Maker. Default is None.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: If an error occurs during the addition of the PID records to Elasticsearch</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">records</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">PIDRecord</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">fromFile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># Check if the PID records should be read from a file</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fromFile</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>  <span class="c1"># read the PID records from the file</span>
                <span class="n">records</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">PIDRecord</span><span class="o">.</span><span class="n">fromJSON</span><span class="p">(</span><span class="n">record</span><span class="p">)</span> <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
                <span class="p">]</span>  <span class="c1"># convert the JSON objects to PID records</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">records</span><span class="p">)</span><span class="si">}</span><span class="s2"> PID records in file </span><span class="si">{</span><span class="n">fromFile</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># Read the PID records from the Typed PID-Maker</span>
            <span class="n">records</span> <span class="o">=</span> <span class="p">(</span>
                <span class="k">await</span> <span class="n">tpm</span><span class="o">.</span><span class="n">getAllPIDRecords</span><span class="p">()</span>
            <span class="p">)</span>  <span class="c1"># get all PID records from the Typed PID-Maker</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">records</span><span class="p">)</span><span class="si">}</span><span class="s2"> PID records in TPM&quot;</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Adding all existing PID records to Elasticsearch&quot;</span><span class="p">)</span>
        <span class="k">await</span> <span class="n">elasticsearch</span><span class="o">.</span><span class="n">addPIDRecords</span><span class="p">(</span>
            <span class="n">records</span>
        <span class="p">)</span>  <span class="c1"># add the PID records to Elasticsearch</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;pid_records_all.json&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>  <span class="c1"># write the PID records to a file</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">([</span><span class="n">record</span><span class="o">.</span><span class="n">toJSON</span><span class="p">()</span> <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">records</span><span class="p">],</span> <span class="n">f</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;PID records written to file pid_records_all.json&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="p">(</span>
        <span class="ne">Exception</span>
    <span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>  <span class="c1"># An error occurred during the addition of the PID records to Elasticsearch</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Error adding PID records to Elasticsearch&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Error adding PID records to Elasticsearch&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="nmr_FAIR_DOs.lib.extractBiggestFAIRDO" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">extractBiggestFAIRDO</span>


<a href="#nmr_FAIR_DOs.lib.extractBiggestFAIRDO" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">extractBiggestFAIRDO</span><span class="p">(</span>
    <span class="n">records</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">PIDRecord</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PIDRecord</span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Extract the biggest FAIR-DO from a list of PID records.
The biggest FAIR-DO is the PID record with the most entries (even if they are from the same data type).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>records</code></td>
            <td>
                  <code>list[<a class="autorefs autorefs-internal" title="nmr_FAIR_DOs.domain.pid_record.PIDRecord" href="../domain/pid_record/#nmr_FAIR_DOs.domain.pid_record.PIDRecord">PIDRecord</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The list of PID records to extract the biggest FAIR-DO from</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>PIDRecord</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="nmr_FAIR_DOs.domain.pid_record.PIDRecord" href="../domain/pid_record/#nmr_FAIR_DOs.domain.pid_record.PIDRecord">PIDRecord</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The biggest FAIR-DO record from the list of PID records</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/nmr_FAIR_DOs/lib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">extractBiggestFAIRDO</span><span class="p">(</span><span class="n">records</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">PIDRecord</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">PIDRecord</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extract the biggest FAIR-DO from a list of PID records.</span>
<span class="sd">    The biggest FAIR-DO is the PID record with the most entries (even if they are from the same data type).</span>

<span class="sd">    Args:</span>
<span class="sd">        records (list[PIDRecord]): The list of PID records to extract the biggest FAIR-DO from</span>

<span class="sd">    Returns:</span>
<span class="sd">        PIDRecord: The biggest FAIR-DO record from the list of PID records</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span>
        <span class="ow">not</span> <span class="n">records</span>
        <span class="ow">or</span> <span class="n">records</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">records</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
        <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">records</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
    <span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Invalid input: records is None or not a list or empty&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">records</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># Only one PID record in the list</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Only one PID record in list. Returning it.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">records</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">biggest_FDO</span> <span class="o">=</span> <span class="n">records</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">biggest_FDO_attributeValue</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">records</span><span class="p">:</span>  <span class="c1"># iterate over the PID records</span>
        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">record</span><span class="o">.</span><span class="n">getEntries</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">biggest_FDO_attributeValue</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;New biggest FAIR-DO: </span><span class="si">{</span><span class="n">record</span><span class="o">.</span><span class="n">getPID</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">biggest_FDO</span> <span class="o">=</span> <span class="n">record</span>
                <span class="n">biggest_FDO_attributeValue</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Found biggest FAIR-DO: </span><span class="si">{</span><span class="n">biggest_FDO</span><span class="o">.</span><span class="n">getPID</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">biggest_FDO</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="nmr_FAIR_DOs.lib.extractRecordWithMostDataTypes" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">extractRecordWithMostDataTypes</span>


<a href="#nmr_FAIR_DOs.lib.extractRecordWithMostDataTypes" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">extractRecordWithMostDataTypes</span><span class="p">(</span>
    <span class="n">records</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">PIDRecord</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PIDRecord</span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Extract the PID record with the most different data types from a list of PID records.
The PID record with the most different data types is the PID record with the most different keys in its entries.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>records</code></td>
            <td>
                  <code>list[<a class="autorefs autorefs-internal" title="nmr_FAIR_DOs.domain.pid_record.PIDRecord" href="../domain/pid_record/#nmr_FAIR_DOs.domain.pid_record.PIDRecord">PIDRecord</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The list of PID records to extract the PID record with the most different data types from</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>PIDRecord</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="nmr_FAIR_DOs.domain.pid_record.PIDRecord" href="../domain/pid_record/#nmr_FAIR_DOs.domain.pid_record.PIDRecord">PIDRecord</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The PID record with the most different data types from the list of PID records</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/nmr_FAIR_DOs/lib.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">extractRecordWithMostDataTypes</span><span class="p">(</span><span class="n">records</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">PIDRecord</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">PIDRecord</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extract the PID record with the most different data types from a list of PID records.</span>
<span class="sd">    The PID record with the most different data types is the PID record with the most different keys in its entries.</span>

<span class="sd">    Args:</span>
<span class="sd">        records (list[PIDRecord]): The list of PID records to extract the PID record with the most different data types from</span>

<span class="sd">    Returns:</span>
<span class="sd">        PIDRecord: The PID record with the most different data types from the list of PID records</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span>
        <span class="ow">not</span> <span class="n">records</span>
        <span class="ow">or</span> <span class="n">records</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">records</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
        <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">records</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
    <span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Invalid input: records is None or not a list or empty&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">records</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># Only one PID record in the list</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Only one PID record in list. Returning it.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">records</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">most_informative_FDO</span> <span class="o">=</span> <span class="n">records</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">records</span><span class="p">:</span>  <span class="c1"># iterate over the PID records</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">getEntries</span><span class="p">())</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">most_informative_FDO</span><span class="o">.</span><span class="n">getEntries</span><span class="p">()):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;New most informative FAIR-DO: </span><span class="si">{</span><span class="n">record</span><span class="o">.</span><span class="n">getPID</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">most_informative_FDO</span> <span class="o">=</span> <span class="n">record</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Found most informative FAIR-DO: </span><span class="si">{</span><span class="n">most_informative_FDO</span><span class="o">.</span><span class="n">getPID</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">most_informative_FDO</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../env/" class="md-footer__link md-footer__link--prev" aria-label="Previous: env">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                env
              </div>
            </div>
          </a>
        
        
          
          <a href="../repositories/" class="md-footer__link md-footer__link--next" aria-label="Next: repositories">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                repositories
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <!--
  ~ SPDX-FileCopyrightText: 2025 Karlsruhe Institute of Technology <maximilian.inckmann@kit.edu>
  ~ SPDX-License-Identifier: Apache-2.0
  ~
  ~ Copyright (c) 2025. Karlsruhe Institute of Technology
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ You may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~   http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->

<!--
  -->

<div class="md-copyright">
  
  
    Made with
    <a
      href="https://squidfunk.github.io/mkdocs-material/"
      target="_blank" rel="noopener"
    >
      Material for MkDocs
    </a>
    <!-- added link to project template -->
    and
    <a
      href="https://github.com/Materials-Data-Science-and-Informatics/fair-python-cookiecutter"
      target="_blank" rel="noopener"
    >
      fair-python-cookiecutter
    </a>
    <!-- ------------------------------ -->
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/kit-data-manager" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["content.action.edit", "content.action.view", "content.code.annotate", "header.autohide", "navigation.footer", "navigation.instant", "navigation.tabs", "navigation.tabs.sticky", "navigation.tracking", "navigation.top", "search.highlight", "search.suggest"], "search": "../../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.f1b6f286.min.js"></script>
      
        <script src="../../../assets/_markdown_exec_pyodide.js"></script>
      
    
  </body>
</html>